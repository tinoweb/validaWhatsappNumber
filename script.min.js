!function(){const e=document.getElementById("numberInput"),t=document.getElementById("importExcel"),n=document.getElementById("validateBtn"),i=document.getElementById("fileInput"),a=document.getElementById("loadingSection"),o=document.getElementById("resultsSection"),s=document.getElementById("resultsTable"),l=document.getElementById("exportExcel"),d=document.querySelector(".progress-bar"),r=document.getElementById("statusText"),c=document.getElementById("premiumMessage");let m=[];function p(e){let t=e.replace(/\s+/g,"").replace(/[^\d,+]/g,"");if(t.includes(","))return t.split(",").map(e=>e.trim()).filter(e=>e.length>=10);let n=[],i="";for(let e=0;e<t.length;e++)if(i+=t[e],i.startsWith("55")&&(12===i.length||13===i.length)&&(n.push(i),i="",t.substring(e+1).startsWith("55")&&(i="")),e===t.length-1&&i.length>=10&&n.push(i),n.length>=10)break;return n.filter(e=>e.length>=10)}document.addEventListener("keydown",function(e){(e.ctrlKey&&e.shiftKey&&"I"===e.key||e.ctrlKey&&e.shiftKey&&"J"===e.key||e.ctrlKey&&"u"===e.key||"F12"===e.key)&&e.preventDefault()}),document.addEventListener("contextmenu",function(e){e.preventDefault()}),t.addEventListener("click",()=>i.click()),i.addEventListener("change",function(t){const n=t.target.files[0];if(!n)return;const i=new FileReader;i.onload=function(t){const n=new Uint8Array(t.target.result),i=XLSX.read(n,{type:"array"}),a=i.Sheets[i.SheetNames[0]],o=XLSX.utils.sheet_to_json(a,{header:1});e.value=o.flat().filter(e=>e&&!isNaN(e.toString().replace(/\D/g,""))).join("\n")},i.readAsArrayBuffer(n)}),n.addEventListener("click",async function(){const e=p(numberInput.value);if(0===e.length)return void alert("Por favor, insira alguns números válidos para validar.");const t=e.slice(0,10);e.length>10&&c.classList.remove("d-none"),a.classList.remove("d-none"),o.classList.add("d-none"),m=[],s.innerHTML="";for(let e=0;e<t.length;e++){const n=t[e];d.style.width=`${(e+1)/t.length*100}%`,r.textContent=`Validando número ${e+1} de ${t.length}...`;try{const e=await fetch("https://apizap.tinowebservices.com/api.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:`phone=${n}`}),t=await e.json();if("business"===t.accountType||"personal"===t.accountType){m.push({number:n,name:t.name||"Não disponível",status:"Válido"});const e=document.createElement("tr");e.innerHTML=`\n                        <td>\n                            ${t.profilePic?`<img src="${t.profilePic}" alt="Foto de perfil" class="rounded-circle" style="width: 40px; height: 40px; object-fit: cover;">`:'<span class="text-muted">n/d</span>'}\n                        </td>\n                        <td>${n}</td>\n                        <td>${t.name||"Não disponível"}</td>\n                        <td>${t.about?(new Date(t.about.split(" ")[1])).toLocaleDateString("pt-BR"):"n/d"}</td>\n                        <td><span class="badge bg-success">Válido (${t.accountType})</span></td>\n                    `,s.appendChild(e)}}catch(e){console.error("Erro ao validar número:",e)}}a.classList.add("d-none"),o.classList.remove("d-none")}),l.addEventListener("click",function(){if(0===m.length)return void alert("Não há números válidos para exportar.");const e=XLSX.utils.json_to_sheet(m),t=XLSX.utils.book_new();XLSX.utils.book_append_sheet(t,e,"Números Válidos"),XLSX.writeFile(t,"numeros_validos_whatsapp.xlsx")})}();
